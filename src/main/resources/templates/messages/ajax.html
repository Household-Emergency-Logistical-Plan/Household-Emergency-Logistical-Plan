<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>View all Messages using AJAX</title>
    <div th:replace="partials/links :: links"></div>
    <nav th:replace="partials/navbar :: navbar"></nav>
    <link th:replace="partials/links :: links"/>

    <!--    <link rel="stylesheet" href="/static/css/messages.css">-->
    <style>
        /* Chat containers */
        .container {
            /*border: 2px solid #dedede;*/
            /*background-color: #f1f1f1;*/
            padding: 10px;
            width: 100%;
            height: 400px;
            margin: 0;
        }

        /* Clear floats */
        /*.container::after {*/
        /*    content: "";*/
        /*    clear: both;*/
        /*    display: table;*/
        /*}*/

        /*!* Style images *!*/
        /*.container img {*/
        /*    float: left;*/
        /*    max-width: 60px;*/
        /*    width: 100%;*/
        /*    margin-right: 20px;*/
        /*    border-radius: 50%;*/
        /*}*/

        /* Style the right image */
        /*.container img.right {*/
        /*    float: right;*/
        /*    margin-left: 20px;*/
        /*    margin-right: 0;*/
        /*}*/


        #container {
            display: flex;
            flex-direction: column-reverse;
        }

        .name {
            font-weight: bold;
        }

        .message-container {
            margin: 5px 0;
        }

        .time {
            font-weight: normal;
        }


    </style>

</head>
<body>

<div id="messages">
    <div class="container" id="container" style="overflow-y:scroll;">
        <div id="reverse-messages">

        </div>

    </div>
    <form th:action="@{/messages/submit}" th:method="post" th:object="${message}">
        <textarea class="form-control" th:field="*{body}" cols="72" rows="5"></textarea>
        <br/>
        <input type="submit"/>
    </form>
</div>


<div th:replace="partials/scripts :: scripts"></div>

<!-- include the JS file with the AJAX request -->
<script type="text/javascript">

    // $(document).ready(function() {
    //     $(".message-container").hover(function () {
    //         $(this).css("background-color", "yellow");
    //     }, function () {
    //         $(this).css("background-color", "pink");
    //     });
    // });

    (function ($) {
        var request = $.ajax({'url': '/messages.json'});
        request.done(function (messages) {
            var html = '';
            messages.forEach(function (message) {
                html += '<div class="message-container">';
                // html += '<img src="/w3images/bandmember.jpg" alt="Avatar">';
                html += '<p class="name">' + message.owner.firstName + message.owner.lastName + '  <span class="time">' + message.createTime + '</span></p>';
                // html += '<span className="time-right">' + message.createDateTime + '</span>';
                html += '<p>' + message.body + '</p>';
                html += '</div>';
            });
            $('#container div').html(html);
        });
    })(jQuery);

</script>
<div th:replace="partials/scripts :: scripts"></div>
</body>
</html>